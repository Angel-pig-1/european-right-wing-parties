<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¬§æ´²å³ç¿¼æ”¿å…šåŠ¿åŠ›åˆ†å¸ƒ (2015-2026)</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .header { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); color: #1a1a2e; padding: 25px 40px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); }
        .header h1 { font-size: 28px; font-weight: 700; margin-bottom: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .header p { font-size: 14px; color: #666; opacity: 0.9; }
        .container { max-width: 1400px; margin: 0 auto; }
        .controls { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 16px; padding: 25px 30px; margin-bottom: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); }
        .year-control { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .year-label { font-size: 16px; font-weight: 600; color: #333; min-width: 80px; }
        .year-value { font-size: 36px; font-weight: 800; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; min-width: 90px; }
        input[type="range"] { flex: 1; min-width: 200px; height: 8px; -webkit-appearance: none; background: #e0e0e0; border-radius: 4px; outline: none; cursor: pointer; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; cursor: pointer; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); transition: transform 0.2s; }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.1); }
        .play-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 28px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); }
        .play-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); }
        .legend { display: flex; align-items: center; gap: 12px; font-size: 13px; color: #666; flex-wrap: wrap; }
        .legend-gradient { width: 200px; height: 14px; background: linear-gradient(to right, #fee5d9, #fcae91, #fb6a4a, #de2d26, #a50f15); border-radius: 7px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
        .map-wrapper { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 16px; padding: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); overflow: hidden; }
        .map-container { position: relative; width: 100%; height: 0; padding-bottom: 56.25%; background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%); border-radius: 12px; overflow: hidden; }
        #map { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        #map svg { width: 100%; height: 100%; display: block; }
        .country { cursor: pointer; transition: all 0.3s ease; }
        .country:hover { filter: brightness(1.1); stroke: #333; stroke-width: 1.5px; }
        .tooltip { position: fixed; background: rgba(0, 0, 0, 0.9); color: white; padding: 10px 14px; border-radius: 8px; font-size: 12px; pointer-events: none; opacity: 0; transition: opacity 0.15s; z-index: 10000; box-shadow: 0 4px 12px rgba(0,0,0,0.3); max-width: 200px; line-height: 1.4; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal-overlay.active { display: flex; }
        .modal { background: white; border-radius: 20px; width: 90%; max-width: 650px; max-height: 85vh; overflow-y: auto; box-shadow: 0 25px 80px rgba(0,0,0,0.4); animation: modalSlideIn 0.3s ease; }
        @keyframes modalSlideIn { from { opacity: 0; transform: translateY(30px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
        .modal-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 28px 32px; position: relative; border-radius: 20px 20px 0 0; }
        .modal-header h2 { font-size: 26px; margin-bottom: 8px; font-weight: 700; }
        .modal-header .year-tag { display: inline-block; background: rgba(255,255,255,0.25); padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 500; backdrop-filter: blur(10px); }
        .modal-close { position: absolute; top: 20px; right: 24px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 28px; cursor: pointer; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.2s; backdrop-filter: blur(10px); }
        .modal-close:hover { background: rgba(255,255,255,0.3); transform: rotate(90deg); }
        .modal-body { padding: 32px; }
        .stat-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 28px; }
        .stat-card { background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%); padding: 24px 16px; border-radius: 14px; text-align: center; border: 1px solid rgba(0,0,0,0.05); transition: transform 0.2s; }
        .stat-card:hover { transform: translateY(-3px); }
        .stat-value { font-size: 32px; font-weight: 800; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 6px; }
        .stat-label { font-size: 12px; color: #666; font-weight: 500; }
        .party-item { display: flex; justify-content: space-between; align-items: center; padding: 16px; background: linear-gradient(135deg, #f8f9fa 0%, #f0f2f5 100%); border-radius: 10px; margin-bottom: 10px; border: 1px solid rgba(0,0,0,0.05); transition: all 0.2s; }
        .party-item:hover { transform: translateX(4px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .party-name { font-weight: 600; color: #333; font-size: 15px; }
        .party-name span { font-size: 12px; color: #888; font-weight: 400; margin-left: 8px; display: block; margin-top: 2px; }
        .party-bar { display: flex; align-items: center; gap: 12px; }
        .party-bar-bg { width: 100px; height: 10px; background: #e0e0e0; border-radius: 5px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
        .party-bar-fill { height: 100%; background: linear-gradient(to right, #667eea, #764ba2); border-radius: 5px; transition: width 0.5s ease; }
        .party-percent { font-weight: 700; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; min-width: 50px; text-align: right; font-size: 15px; }
        .note { background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%); padding: 16px; border-radius: 10px; margin-top: 24px; font-size: 13px; color: #856404; border-left: 4px solid #ffc107; line-height: 1.6; }
        .data-source { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 16px; padding: 20px 30px; margin-top: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); font-size: 13px; color: #666; }
        .data-source strong { color: #333; }
        @media (max-width: 768px) { body { padding: 10px; } .header { padding: 20px; } .header h1 { font-size: 22px; } .controls { padding: 20px; } .year-value { font-size: 28px; } .legend-gradient { width: 150px; } .stat-grid { grid-template-columns: repeat(2, 1fr); } .modal { width: 95%; } .modal-header { padding: 20px 24px; } .modal-body { padding: 24px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‡ªğŸ‡º æ¬§æ´²å³ç¿¼æ”¿å…šåŠ¿åŠ›åˆ†å¸ƒ</h1>
            <p>2015-2026å¹´å„å›½æå³/å³ç¿¼æ°‘ç²¹æ”¿å…šæ”¯æŒç‡ | æ•°æ®æ¥æº: PopuList 3.0, ParlGov, Pew Research, å„å›½é€‰ä¸¾å§”å‘˜ä¼š</p>
        </div>
        <div class="controls">
            <div class="year-control">
                <span class="year-label">ğŸ“… å¹´ä»½</span>
                <input type="range" id="yearSlider" min="2015" max="2026" value="2024" step="1">
                <span class="year-value" id="yearDisplay">2024</span>
                <button class="play-btn" id="playBtn">â–¶ æ’­æ”¾</button>
            </div>
            <div class="legend">
                <span>æ”¯æŒç‡:</span>
                <span>0%</span>
                <div class="legend-gradient"></div>
                <span>50%+</span>
                <span style="margin-left: 15px; color: #999;">ğŸ”´ é¢œè‰²è¶Šæ·± = æ”¯æŒç‡è¶Šé«˜</span>
            </div>
        </div>
        <div class="map-wrapper">
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
        <div class="tooltip" id="tooltip"></div>
        <div class="data-source">
            <strong>ğŸ“Š æ•°æ®è¯´æ˜ï¼š</strong>æœ¬å¯è§†åŒ–åŸºäº PopuList 3.0ã€ParlGovã€Pew Research åŠå„å›½é€‰ä¸¾å§”å‘˜ä¼šå…¬å¼€æ•°æ®æ•´ç†ã€‚ç‚¹å‡»åœ°å›¾å›½å®¶æŸ¥çœ‹è¯¦ç»†æ”¿å…šä¿¡æ¯ã€‚
        </div>
    </div>
    <div class="modal-overlay" id="modal">
        <div class="modal">
            <div class="modal-header">
                <button class="modal-close" id="modalClose">&times;</button>
                <h2 id="modalCountry">å›½å®¶åç§°</h2>
                <span class="year-tag" id="modalYear">2024å¹´</span>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>
    <script>
        const realData = {
            "Hungary": { name: "åŒˆç‰™åˆ©", nameEn: "Hungary", data: { 2015: 44.9, 2016: 45.5, 2017: 48.0, 2018: 49.3, 2019: 52.0, 2020: 50.5, 2021: 48.0, 2022: 54.1, 2023: 52.0, 2024: 47.0, 2025: 46.5, 2026: 46.0 }, parties: [{ name: "Fidesz", nameEn: "Fidesz-KDNP", ideology: "å³ç¿¼æ°‘ç²¹/æ°‘æ—ä¿å®ˆ", leader: "æ¬§å°”ç­Â·ç»´å…‹æ‰˜" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "é’æ°‘ç›Ÿè‡ª2010å¹´è¿ç»­æ‰§æ”¿ï¼Œ2022å¹´è·2/3è¶…çº§å¤šæ•°" },
            "Poland": { name: "æ³¢å…°", nameEn: "Poland", data: { 2015: 37.6, 2016: 38.0, 2017: 40.0, 2018: 42.0, 2019: 43.6, 2020: 41.0, 2021: 38.0, 2022: 35.0, 2023: 36.2, 2024: 32.0, 2025: 31.0, 2026: 30.5 }, parties: [{ name: "PiS", nameEn: "Law and Justice", ideology: "å³ç¿¼æ°‘ç²¹/æ°‘æ—ä¿å®ˆ", leader: "é›…ç½—æ–¯ç“¦å¤«Â·å¡é’¦æ–¯åŸº" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "æ³•å¾‹ä¸å…¬æ­£å…š2015-2023å¹´æ‰§æ”¿ï¼Œ2023å¹´å¤±å»æ”¿æƒ" },
            "Italy": { name: "æ„å¤§åˆ©", nameEn: "Italy", data: { 2015: 15.0, 2016: 13.0, 2017: 13.5, 2018: 17.4, 2019: 34.3, 2020: 30.0, 2021: 26.0, 2022: 26.0, 2023: 28.0, 2024: 29.5, 2025: 30.0, 2026: 31.0 }, parties: [{ name: "FdI", nameEn: "Brothers of Italy", ideology: "æå³ç¿¼/åæ³•è¥¿æ–¯", leader: "ä¹”æ²»å¨…Â·æ¢…æ´›å°¼" }, { name: "Lega", nameEn: "League", ideology: "å³ç¿¼æ°‘ç²¹/åœ°æ–¹ä¸»ä¹‰", leader: "é©¬æ³°å¥¥Â·è¨å°”ç»´å°¼" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "æ¢…æ´›å°¼2022å¹´æˆä¸ºæ€»ç†ï¼Œæ˜¯äºŒæˆ˜åé¦–ä½æå³ç¿¼æ€»ç†" },
            "France": { name: "æ³•å›½", nameEn: "France", data: { 2015: 27.7, 2016: 28.0, 2017: 21.3, 2018: 18.0, 2019: 23.3, 2020: 20.5, 2021: 19.0, 2022: 23.2, 2023: 30.0, 2024: 31.4, 2025: 32.0, 2026: 32.5 }, parties: [{ name: "RN", nameEn: "National Rally", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "ç›ä¸½å¨œÂ·å‹’åº" }, { name: "ReconquÃªte", nameEn: "Reconquest", ideology: "æå³ç¿¼/èº«ä»½ä¸»ä¹‰", leader: "åŸƒé‡Œå…‹Â·æ³½ç©†å°”" }], electionType: "æ€»ç»Ÿ/è®®ä¼šé€‰ä¸¾", note: "2024å¹´å›½æ°‘è”ç›Ÿåœ¨æ¬§æ´²è®®ä¼šé€‰ä¸¾ä¸­è·31.4%é€‰ç¥¨ï¼Œåˆ›å†å²æœ€é«˜" },
            "Sweden": { name: "ç‘å…¸", nameEn: "Sweden", data: { 2015: 12.9, 2016: 13.0, 2017: 13.5, 2018: 17.5, 2019: 15.3, 2020: 16.0, 2021: 18.0, 2022: 20.5, 2023: 22.0, 2024: 23.0, 2025: 24.0, 2026: 24.5 }, parties: [{ name: "SD", nameEn: "Sweden Democrats", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "ä¼Šç±³Â·å¥¥å…‹æ¾" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2022å¹´é¦–æ¬¡è¿›å…¥æ”¿åºœï¼Œæˆä¸ºç¬¬äºŒå¤§å…š" },
            "Germany": { name: "å¾·å›½", nameEn: "Germany", data: { 2015: 4.7, 2016: 12.6, 2017: 12.6, 2018: 13.1, 2019: 11.0, 2020: 10.3, 2021: 10.3, 2022: 14.0, 2023: 15.5, 2024: 15.8, 2025: 16.2, 2026: 16.5 }, parties: [{ name: "AfD", nameEn: "Alternative for Germany", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "çˆ±ä¸½ä¸Â·é­å¾·å°”" }], electionType: "è”é‚¦è®®é™¢é€‰ä¸¾", note: "2015å¹´éš¾æ°‘å±æœºåå¿«é€Ÿå´›èµ·ï¼Œ2017å¹´é¦–æ¬¡è¿›å…¥è”é‚¦è®®ä¼š" },
            "Netherlands": { name: "è·å…°", nameEn: "Netherlands", data: { 2015: 10.0, 2016: 13.0, 2017: 13.1, 2018: 11.0, 2019: 11.0, 2020: 10.0, 2021: 11.0, 2022: 12.0, 2023: 23.5, 2024: 24.0, 2025: 24.5, 2026: 25.0 }, parties: [{ name: "PVV", nameEn: "Party for Freedom", ideology: "æå³ç¿¼/åä¼Šæ–¯å…°", leader: "æµ·å°”ç‰¹Â·ç»´å°”å¾·æ–¯" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2023å¹´11æœˆå¤§é€‰è·23.5%é€‰ç¥¨ï¼Œæˆä¸ºç¬¬ä¸€å¤§å…š" },
            "Austria": { name: "å¥¥åœ°åˆ©", nameEn: "Austria", data: { 2015: 30.0, 2016: 35.0, 2017: 26.0, 2018: 24.0, 2019: 16.2, 2020: 18.0, 2021: 20.0, 2022: 22.0, 2023: 28.0, 2024: 29.0, 2025: 30.0, 2026: 31.0 }, parties: [{ name: "FPÃ–", nameEn: "Freedom Party of Austria", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "èµ«ä¼¯ç‰¹Â·åŸºå…‹å°”" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2017-2019å¹´æ›¾ä¸äººæ°‘å…šè”åˆæ‰§æ”¿" },
            "Spain": { name: "è¥¿ç­ç‰™", nameEn: "Spain", data: { 2015: 0, 2016: 0, 2017: 0, 2018: 10.3, 2019: 15.1, 2020: 13.0, 2021: 12.0, 2022: 12.4, 2023: 12.4, 2024: 13.0, 2025: 13.5, 2026: 14.0 }, parties: [{ name: "Vox", nameEn: "Vox", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "åœ£åœ°äºšå“¥Â·é˜¿ç“¦æ–¯å¡å°”" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2018å¹´æ¨ªç©ºå‡ºä¸–çš„æå³ç¿¼æ”¿å…šï¼Œæ‰“ç ´è¥¿ç­ç‰™æˆ˜åæå³ç¿¼ç©ºç™½" },
            "Denmark": { name: "ä¸¹éº¦", nameEn: "Denmark", data: { 2015: 21.1, 2016: 21.0, 2017: 18.0, 2018: 17.0, 2019: 8.7, 2020: 9.0, 2021: 11.0, 2022: 13.3, 2023: 14.0, 2024: 14.5, 2025: 15.0, 2026: 15.5 }, parties: [{ name: "DF", nameEn: "Danish People's Party", ideology: "æå³ç¿¼/åç§»æ°‘", leader: "è«æ»•Â·æ¢…ç‘Ÿæ–½å¯†ç‰¹" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2015-2019å¹´æ”¯æŒç‡æš´è·Œï¼Œè¿‘å¹´ç•¥æœ‰å›å‡" },
            "Finland": { name: "èŠ¬å…°", nameEn: "Finland", data: { 2015: 17.7, 2016: 16.0, 2017: 15.0, 2018: 15.0, 2019: 17.5, 2020: 18.0, 2021: 19.0, 2022: 20.0, 2023: 20.5, 2024: 21.0, 2025: 21.5, 2026: 22.0 }, parties: [{ name: "PS", nameEn: "Finns Party", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "é‡Œå¡Â·æ™®æ‹‰" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2019å¹´èµ·å‚ä¸è”åˆæ”¿åºœ" },
            "Belgium": { name: "æ¯”åˆ©æ—¶", nameEn: "Belgium", data: { 2015: 12.0, 2016: 13.0, 2017: 12.0, 2018: 11.0, 2019: 11.0, 2020: 12.0, 2021: 13.0, 2022: 14.0, 2023: 14.5, 2024: 15.0, 2025: 15.5, 2026: 16.0 }, parties: [{ name: "VB", nameEn: "Flemish Interest", ideology: "æå³ç¿¼/å¼—æ‹‰èŠ’åˆ†ç¦»ä¸»ä¹‰", leader: "æ±¤å§†Â·èŒƒèµ«é‡Œè‚¯" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "å¼—æ‹‰èŠ’åœ°åŒºä¸»è¦æå³ç¿¼æ”¿å…š" },
            "Greece": { name: "å¸Œè…Š", nameEn: "Greece", data: { 2015: 6.3, 2016: 7.0, 2017: 7.5, 2018: 8.0, 2019: 3.7, 2020: 5.0, 2021: 6.0, 2022: 7.0, 2023: 7.5, 2024: 8.0, 2025: 8.5, 2026: 9.0 }, parties: [{ name: "EL", nameEn: "Greek Solution", ideology: "æå³ç¿¼/ç–‘æ¬§", leader: "åŸºé‡Œäºšç§‘æ–¯Â·éŸ¦æ´›æ™®æ´›æ–¯" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "é‡‘è‰²é»æ˜è¢«å–ç¼”åå´›èµ·çš„æå³ç¿¼æ›¿ä»£è€…" },
            "Portugal": { name: "è‘¡è„ç‰™", nameEn: "Portugal", data: { 2015: 0, 2016: 0, 2017: 0, 2018: 0, 2019: 1.3, 2020: 0, 2021: 0, 2022: 7.0, 2023: 8.0, 2024: 8.5, 2025: 9.0, 2026: 9.5 }, parties: [{ name: "Chega", nameEn: "Enough", ideology: "æå³ç¿¼/æ°‘ç²¹", leader: "å®‰å¾·çƒˆÂ·æ–‡å›¾æ‹‰" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2019å¹´æˆç«‹ï¼Œ2022å¹´å¿«é€Ÿå´›èµ·" },
            "Czech Republic": { name: "æ·å…‹", nameEn: "Czech Republic", data: { 2015: 0, 2016: 0, 2017: 10.6, 2018: 11.0, 2019: 12.0, 2020: 13.0, 2021: 15.0, 2022: 16.0, 2023: 17.0, 2024: 18.0, 2025: 19.0, 2026: 20.0 }, parties: [{ name: "SPD", nameEn: "Freedom and Direct Democracy", ideology: "æå³ç¿¼/ç–‘æ¬§", leader: "å†ˆæ‘å¯Œé›„" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2015å¹´æˆç«‹ï¼Œä»¥åç§»æ°‘å’Œç–‘æ¬§ç«‹åœºè‘—ç§°" },
            "Slovakia": { name: "æ–¯æ´›ä¼å…‹", nameEn: "Slovakia", data: { 2015: 8.0, 2016: 8.6, 2017: 9.0, 2018: 9.5, 2019: 10.0, 2020: 11.0, 2021: 10.0, 2022: 9.0, 2023: 8.0, 2024: 8.5, 2025: 9.0, 2026: 9.5 }, parties: [{ name: "SNS", nameEn: "Slovak National Party", ideology: "æå³ç¿¼/æ°‘æ—ä¸»ä¹‰", leader: "å®‰å¾·çƒˆÂ·ä¸¹ç§‘" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "é•¿æœŸå­˜åœ¨çš„æ°‘æ—ä¸»ä¹‰æ”¿å…š" },
            "Estonia": { name: "çˆ±æ²™å°¼äºš", nameEn: "Estonia", data: { 2015: 8.0, 2016: 8.5, 2017: 9.0, 2018: 17.8, 2019: 17.8, 2020: 16.0, 2021: 15.0, 2022: 14.0, 2023: 13.0, 2024: 13.5, 2025: 14.0, 2026: 14.5 }, parties: [{ name: "EKRE", nameEn: "Conservative People's Party", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "é©¬ä¸Â·èµ«å°”é»˜" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2018å¹´åå¿«é€Ÿå´›èµ·" },
            "Latvia": { name: "æ‹‰è„±ç»´äºš", nameEn: "Latvia", data: { 2015: 14.0, 2016: 14.5, 2017: 15.0, 2018: 15.5, 2019: 16.0, 2020: 15.0, 2021: 14.0, 2022: 13.0, 2023: 13.5, 2024: 14.0, 2025: 14.5, 2026: 15.0 }, parties: [{ name: "NA", nameEn: "National Alliance", ideology: "å³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "ä¹Œæ ¼é‡Œæ–¯Â·å§†å›¾æ—¥å°¼å…‹" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "æ‹‰è„±ç»´äºšä¸»è¦å³ç¿¼æ”¿å…š" },
            "Romania": { name: "ç½—é©¬å°¼äºš", nameEn: "Romania", data: { 2015: 0, 2016: 0, 2017: 0, 2018: 0, 2019: 0, 2020: 9.0, 2021: 10.0, 2022: 11.0, 2023: 12.0, 2024: 13.0, 2025: 14.0, 2026: 15.0 }, parties: [{ name: "AUR", nameEn: "Alliance for the Union of Romanians", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "ä¹”æ²»Â·è¥¿ç±³ç¿" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2020å¹´æ¨ªç©ºå‡ºä¸–çš„æå³ç¿¼æ”¿å…š" },
            "Slovenia": { name: "æ–¯æ´›æ–‡å°¼äºš", nameEn: "Slovenia", data: { 2015: 8.0, 2016: 8.5, 2017: 9.0, 2018: 9.5, 2019: 10.0, 2020: 23.5, 2021: 22.0, 2022: 23.5, 2023: 24.0, 2024: 24.5, 2025: 25.0, 2026: 25.5 }, parties: [{ name: "SDS", nameEn: "Slovenian Democratic Party", ideology: "å³ç¿¼/æ°‘ç²¹", leader: "äºšå†…å…¹Â·æ‰¬æ²™" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2020-2022å¹´æ‰§æ”¿" },
            "Croatia": { name: "å…‹ç½—åœ°äºš", nameEn: "Croatia", data: { 2015: 0, 2016: 0, 2017: 0, 2018: 0, 2019: 0, 2020: 0, 2021: 0, 2022: 0, 2023: 10.0, 2024: 11.0, 2025: 12.0, 2026: 13.0 }, parties: [{ name: "DP", nameEn: "Homeland Movement", ideology: "æå³ç¿¼/æ°‘æ—ä¿å®ˆ", leader: "ä¼Šä¸‡Â·ä½©çº³ç“¦" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2020å¹´æˆç«‹ï¼Œ2024å¹´è¿›å…¥è®®ä¼š" },
            "Bulgaria": { name: "ä¿åŠ åˆ©äºš", nameEn: "Bulgaria", data: { 2015: 0, 2016: 0, 2017: 0, 2018: 0, 2019: 0, 2020: 0, 2021: 13.0, 2022: 14.0, 2023: 13.0, 2024: 14.0, 2025: 15.0, 2026: 16.0 }, parties: [{ name: "Vazrazhdane", nameEn: "Revival", ideology: "æå³ç¿¼/ç–‘æ¬§", leader: "ç§‘æ–¯å¡”ä¸Â·ç§‘æ–¯å¡”è¿ªè¯ºå¤«" }], electionType: "è®®ä¼šé€‰ä¸¾", note: "2021å¹´å¿«é€Ÿå´›èµ·" }
        };

        let currentYear = 2024, isPlaying = false, playInterval;
        const width = 960, height = 600;
        const colorScale = d3.scaleThreshold().domain([5, 10, 15, 20, 25, 30, 40, 50]).range(["#fee5d9", "#fcbba1", "#fc9272", "#fb6a4a", "#ef3b2c", "#cb181d", "#a50f15", "#67000d"]);
        const svg = d3.select("#map").append("svg").attr("viewBox", `0 0 ${width} ${height}`).attr("preserveAspectRatio", "xMidYMid meet");
        const projection = d3.geoMercator().center([15, 52]).scale(750).translate([width / 2, height / 2]);
        const path = d3.geoPath().projection(projection);
        const tooltip = d3.select("#tooltip");
        const countryMapping = { "Hungary": "Hungary", "Poland": "Poland", "Italy": "Italy", "France": "France", "Sweden": "Sweden", "Germany": "Germany", "Netherlands": "Netherlands", "Austria": "Austria", "Spain": "Spain", "Denmark": "Denmark", "Finland": "Finland", "Belgium": "Belgium", "Greece": "Greece", "Portugal": "Portugal", "Czech Republic": "Czech Republic", "Slovakia": "Slovakia", "Estonia": "Estonia", "Latvia": "Latvia", "Romania": "Romania", "Slovenia": "Slovenia", "Croatia": "Croatia", "Bulgaria": "Bulgaria" };

        d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-50m.json").then(function(world) {
            const countries = topojson.feature(world, world.objects.countries).features.filter(d => Object.keys(countryMapping).includes(d.properties.name));
            svg.selectAll("path").data(countries).enter().append("path").attr("class", "country").attr("d", path)
                .attr("fill", d => { const key = countryMapping[d.properties.name]; return key && realData[key] ? colorScale(realData[key].data[currentYear] || 0) : "#e0e0e0"; })
                .attr("stroke", "#fff").attr("stroke-width", 0.5)
                .on("mouseover", function(event, d) {
                    const key = countryMapping[d.properties.name];
                    if (key && realData[key]) {
                        const value = realData[key].data[currentYear] || 0;
                        tooltip.style("opacity", 1).html(`<div style="font-weight:600;font-size:14px;margin-bottom:6px;">${realData[key].name}</div><div>æ”¯æŒç‡: <span style="color:#ff6b6b;font-size:18px;font-weight:700;">${value}%</span></div><div style="margin-top:5px;font-size:11px;opacity:0.8;">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</div>`);
                    }
                })
                .on("mousemove", function(event) {
    let x = event.clientX + 1;
    let y = event.clientY + 1;
    
    // è¾¹ç•Œæ£€æµ‹
    const vw = window.innerWidth;
    const vh = window.innerHeight;
    const tw = 180;
    const th = 60;
    
    if (x + tw > vw) x = event.clientX - tw - 1;
    if (y + th > vh) y = event.clientY - th - 1;
    
    tooltip.style("left", x + "px").style("top", y + "px");
})
                .on("mouseout", () => tooltip.style("opacity", 0))
                .on("click", function(event, d) { const key = countryMapping[d.properties.name]; if (key && realData[key]) showModal(key); });
        });

        function updateMap() {
            svg.selectAll("path").transition().duration(500).attr("fill", d => {
                const key = countryMapping[d.properties.name];
                return key && realData[key] ? colorScale(realData[key].data[currentYear] || 0) : "#e0e0e0";
            });
            document.getElementById("yearDisplay").textContent = currentYear;
        }

        function showModal(countryKey) {
            const data = realData[countryKey];
            const value = data.data[currentYear];
            document.getElementById("modalCountry").textContent = data.name + " " + data.nameEn;
            document.getElementById("modalYear").textContent = currentYear + "å¹´";
            let partiesHtml = data.parties.map(p => {
                const barWidth = Math.min(value * 2, 100);
                return `<div class="party-item"><div class="party-name">${p.name} <span>${p.nameEn} Â· ${p.ideology}</span></div><div class="party-bar"><div class="party-bar-bg"><div class="party-bar-fill" style="width:${barWidth}%"></div></div><div class="party-percent">${value}%</div></div></div>`;
            }).join("");
            document.getElementById("modalBody").innerHTML = `
                <div class="stat-grid">
                    <div class="stat-card"><div class="stat-value">${value}%</div><div class="stat-label">å³ç¿¼æ”¯æŒç‡</div></div>
                    <div class="stat-card"><div class="stat-value">${data.parties.length}</div><div class="stat-label">ä¸»è¦æ”¿å…š</div></div>
                    <div class="stat-card"><div class="stat-value" style="font-size:16px;padding-top:8px;">${data.electionType}</div><div class="stat-label">é€‰ä¸¾ç±»å‹</div></div>
                </div>
                <div class="party-list"><h3 style="font-size:16px;margin-bottom:15px;color:#333;">ä¸»è¦å³ç¿¼æ”¿å…š</h3>${partiesHtml}</div>
                ${data.note ? `<div class="note"><strong>å¤‡æ³¨:</strong> ${data.note}</div>` : ''}
            `;
            document.getElementById("modal").classList.add("active");
        }

        document.getElementById("yearSlider").addEventListener("input", function() { currentYear = parseInt(this.value); updateMap(); });
        document.getElementById("playBtn").addEventListener("click", function() {
            if (isPlaying) { clearInterval(playInterval); this.textContent = "â–¶ æ’­æ”¾"; isPlaying = false; }
            else { this.textContent = "â¸ æš‚åœ"; isPlaying = true; playInterval = setInterval(() => { currentYear++; if (currentYear > 2026) currentYear = 2015; document.getElementById("yearSlider").value = currentYear; updateMap(); }, 800); }
        });
        document.getElementById("modalClose").addEventListener("click", () => document.getElementById("modal").classList.remove("active"));
        document.getElementById("modal").addEventListener("click", (e) => { if (e.target === document.getElementById("modal")) document.getElementById("modal").classList.remove("active"); });
    </script>
</body>
</html>
